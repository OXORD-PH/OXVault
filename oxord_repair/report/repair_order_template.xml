<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_repair_order_document">
        <t t-name="report_repair_order_document">
            <main>

                <div style="height:4mm;"></div>

                <t t-foreach="docs" t-as="o">

                    <!-- FULL PAGE BACKGROUND -->
                    <img
                        t-att-src="'/oxord_repair/static/src/img/background.jpg'"
                        style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; object-fit:cover;"
                    />

                    <style>
                        @page { size:A4; margin:8mm; }
                        main { page-break-after:avoid; page-break-before:avoid; }

                        .oxord-body-wrapper {
                            width:100%;
                            padding:2mm 6mm;
                            box-sizing:border-box;
                        }

                        .oxord-section {
                            background-color:#e0f2f1;
                            color:#000000;
                            padding:2px 4px;
                            font-weight:bold;
                            margin-top:1.5mm;
                            border-left:2px solid #00796b;
                            border-radius:3px;
                            font-size:12px;
                        }

                        .tech-box {
                            border:1px solid #00796b;
                            border-radius:5px;
                            padding:3px 5px;
                            margin-bottom:1.5mm;
                            background-color:#f0f5f5;
                            font-size:12px;
                        }

                        .tech-box table {
                            width:100%;
                            border-collapse:collapse;
                        }

                        .tech-box td, .tech-box th {
                            padding:2px 3px;
                            font-size:12px;
                            vertical-align:top;
                        }

                        .total-row {
                            border-top:1px solid #00796b;
                            font-weight:bold;
                        }

                        .oxord-footer {
                            font-size:9px;
                            color:#555;
                            margin-top:5px;
                            text-align:center;
                        }
                    </style>

                    <!-- HEADER -->
                    <table style="width:100%; border-bottom:2px solid #009688; margin-bottom:1mm;">
                        <tr>
                            <td style="width:22%; padding-left:6mm;">
                                <img t-if="o.company_id.logo"
                                     t-att-src="'data:image/png;base64,%s' % o.company_id.logo.decode()"
                                     style="height:50px;"
                                     alt="Company Logo"/>
                            </td>
                            <td style="color:#000000;">
                                <div style="font-weight:bold; font-size:15px;">
                                    OXORD COMPUTER SOLUTIONS &amp; REPAIR CENTER
                                </div>
                                <div style="font-size:12px;">
                                    2F Robinsons Place Roxas, Pueblo de Panay Lawa-an Roxas City;                                
                                </div>
                                <div style="font-size:12px;">
                                    La Hacienda Annex Bldg., Arnaldo Blvd., Roxas City, Capiz
                                </div>
                            </td>
                        </tr>
                    </table>

                    <!-- BODY -->
                    <div class="oxord-body-wrapper">

                        <div style="font-weight:bold; color:#000000; font-size:15px;">
                            CLAIM FORM NO: <t t-esc="o.name"/>
                        </div>

                        <!-- CUSTOMER INFORMATION -->
                        <div class="oxord-section">Customer Information</div>
                        <div class="tech-box">
                            <table>
                                <tr><td>Customer:</td><td><t t-esc="o.partner_id.name or '-'"/></td></tr>
                                <tr>
                                    <td>Address:</td>
                                    <td>
                                        <t t-esc="o.partner_street or ''"/>
                                        <t t-esc="o.partner_city or ''"/>
                                        <t t-esc="o.partner_zip or ''"/>
                                    </td>
                                </tr>
                                <tr><td>Telephone:</td><td><t t-esc="o.partner_id.phone or '-'"/></td></tr>
                                <tr><td>Email:</td><td><t t-esc="o.partner_id.email or '-'"/></td></tr>
                                <tr><td>Facebook:</td><td><t t-esc="o.partner_id.facebook or '-'"/></td></tr>
                            </table>
                        </div>

                        <!-- UNIT INFORMATION (COMPACT) -->
                        <div class="oxord-section">Unit Information</div>
                        <div class="tech-box">
                            <table>
                                <tr>
                                    <td style="width:50%;">
                                        <table>
                                            <tr><td>Department:</td><td><t t-esc="o.department_id.name or '-'"/></td></tr>
                                            <tr><td>Unit Type:</td><td><t t-esc="o.unit_type_id.name or '-'"/></td></tr>
                                            <tr><td>Brand:</td><td><t t-esc="o.brand_id.name or '-'"/></td></tr>
                                            <tr><td>Model:</td><td><t t-esc="o.model_id.name or '-'"/></td></tr>
                                        </table>
                                    </td>
                                    <td style="width:50%;">
                                        <table>
                                            <tr><td>Serial No.:</td><td><t t-esc="o.serial or '-'"/></td></tr>
                                            <tr><td>Accessories:</td><td><t t-esc="' , '.join([a.name for a in o.accessory_ids]) or '-'"/></td></tr>
                                            <tr><td>Password:</td><td><t t-esc="o.password or '-'"/></td></tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </div>


                        <!-- RECEIVING DETAILS -->
                        <div class="oxord-section">Receiving Details</div>
                        <div class="tech-box">
                            <table>
                                <tr><td>Received Date:</td><td><t t-esc="o._format_datetime(o.received_date)"/></td></tr>
                                <tr><td>Received By:</td><td><t t-esc="o.received_by.name or '-'"/></td></tr>
                                <tr><td>Remarks:</td><td><t t-esc="o.remarks or '-'"/></td></tr>
                                <tr><td>Service Type:</td><td><t t-esc="dict(o._fields['service_type'].selection).get(o.service_type)"/></td></tr>
                                <tr><td>Branch:</td><td><t t-esc="dict(o._fields['branch'].selection).get(o.branch)"/></td></tr>
                                <tr><td>POP Date:</td><td><t t-esc="o.pop_date or '-'"/></td></tr>
                                <tr><td>Warranty Expiry Date:</td><td><t t-esc="o.warranty_expiry_date or '-'"/></td></tr>
                                <tr><td>Warranty Status:</td><td><t t-esc="dict(o._fields['warranty_status'].selection).get(o.warranty_status) or '-'"/></td></tr>
                            </table>
                        </div>

                        <!-- SERVICE DETAILS -->
                        <div class="oxord-section">Service Details</div>
                        <div class="tech-box">
                            <table>
                                <tr><td>Technician:</td><td><t t-esc="o.endorse_to_tech.name or '-'"/></td></tr>
                                <tr><td>Action Taken:</td><td><t t-esc="o.action_taken or '-'"/></td></tr>
                                <tr><td>Technician Remarks:</td><td><t t-esc="o.technician_remarks or '-'"/></td></tr>
                            </table>
                        </div>

                        <!-- REPAIR SERVICES & COST -->
                        <div class="oxord-section">Repair Services &amp; Estimated Cost</div>
                        <div class="tech-box">
                            <table>
                                <tr style="border-bottom:1px solid #00796b;">
                                    <th style="text-align:left;">Service</th>
                                    <th style="text-align:right;">Estimated Cost</th>
                                </tr>

                                <t t-set="total_cost" t-value="0.0"/>

                                <t t-foreach="o.problem_ids" t-as="p">
                                    <tr>
                                        <td><t t-esc="p.display_name or p.name"/></td>
                                        <td style="text-align:right;">
                                            <t t-esc="'PHP %.2f' % (p.estimated_cost or 0.0)"/>
                                            <t t-set="total_cost" t-value="total_cost + (p.estimated_cost or 0.0)"/>
                                        </td>
                                    </tr>
                                </t>

                                <tr class="total-row">
                                    <td style="text-align:right;">TOTAL</td>
                                    <td style="text-align:right;">
                                        <t t-esc="'PHP %.2f' % total_cost"/>
                                    </td>
                                </tr>
                            </table>
                        </div>


                        <div class="oxord-section">Terms &amp; Conditions</div>
                        <div class="tech-box" style="font-size:12px; line-height:1.25em;">
                        
                            <ol style="padding-left:18px;">
                                <li>I am the owner, and I permitted OXORD Computer Solutions &amp; Repair Center to perform the necessary repair and replace the needed parts (if necessary).</li>
                                <li>The unit was checked in my presence and the details and remarks stated above are true.</li>
                                <li>A CLAIM FORM should be presented upon claiming the unit. I understand that if no claim form is presented, my unit will not be released.</li>
                                <li>If the warranty is void or expired, I will pay for labor and/or parts.</li>
                                <li>I shall pay the check-up fee for my out-of-warranty unit in the amount of three hundred fifty pesos (<span style="background-color: yellow; font-weight: bold;">Php350</span>).</li>
                                <li>I understand that I have been given 7 days to claim the unit after I receive notification form OXORD to claim the unit, and if the unit is unclaimed after 7 days, I will be charged a storage fee of 50 persos per day if not claimed within 30 days.</li>
                                <li>I undersand that after 30 days, my unclaimed unit will be forfeited to cover the cost of storage and I authorize OXORD Computer Solutions &amp; Repair Center to dispose of my unit if I fail to pick-up or pull-out.</li>
                                <li>In such a manner that i cannot claim my unit, I will send my authorized representative with an authorization letter and proof of identification to claim my unit.</li>
                                <li>I shall hold OXORD Computer Solutions &amp; Repair Center free from liability and no responsibility in the event of loss or damage cause by a natural disaster such as a fire, flood, typhoon, or force majeure.</li>
                                <li>I understand that I am responsible for saving or backing up any data on my unit's storage device(s) before sending it to OXORD for service. OXORD will not be responsible for any damage or loss due to the loss or corruption of data in my unit. Once OXORD receives the unit, I understand that it is ready for format (if needed).</li>
                                <li>OXORD Computer Solutions &amp; Repair Center collects and processes personal information solely for legitimate business purposes, in accordance with the Philippine Data Privacy Act (RA 10173). Customer data is kept confidential and shared only when necessary for order fulfillment or as required by law.</li>
                            </ol>
                        
                            <!-- AGREEMENT SIGNATURE (RIGHT SIDE) -->
                            <div style="text-align:right; margin-top:8px;">
                                I hereby agree to the above terms and conditions,<br/><br/><br/>
                                ______________________________<br/>
                                Printed Name and Signature<br/>
                                Date: ________________________
                            </div>
                        
                        </div>
                        
                        <div class="oxord-section">Acknowledgement Upon Release</div>
                        <div class="tech-box" style="font-size:12px;">
                        
                            Received above unit in good condition.
                        
                            <table style="width:100%; margin-top:10px;">
                                <tr>
                                    <!-- LEFT SIDE -->
                                    <td style="width:50%; vertical-align:top; text-align:left;">
                                        <strong>Customer:</strong><br/><br/><br/>
                                        ______________________________<br/>
                                        Printed Name and Signature<br/>
                                        Date: ________________________
                                    </td>
                        
                                    <!-- RIGHT SIDE -->
                                    <td style="width:50%; vertical-align:top; text-align:right;">
                                        <strong>Released By:</strong><br/><br/><br/>
                                        ______________________________<br/>
                                        Printed Name and Signature<br/>
                                        Date: ________________________
                                    </td>
                                </tr>
                            </table>
                        
                        </div>


                        <!-- FOOTER -->
                        <div class="oxord-footer">
                            <div>
                                <strong>Office:</strong>
                                (036) 522-2552 | GLOBE ·
                                (036) 621-3621 | PLDT
                            </div>
                            <div>
                                <strong>Service:</strong>
                                0963 391 9832 | GLOBE ·
                                (036) 520-7055
                            </div>
                            <div>
                                <strong>Sales:</strong>
                                0963 045 4012 | GLOBE ·
                                (036) 621-3812 | PLDT
                            </div>
                            <div style="margin-top:3px;">
                                This document is system-generated by OXORD Digital Infrastructure Solutions.
                            </div>
                        </div>


                    </div>
                </t>
            </main>
        </t>
    </template>

</odoo>
