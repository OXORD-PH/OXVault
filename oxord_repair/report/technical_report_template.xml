<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_technical_report_document">
        <t t-name="report_technical_report_document">
            <main>

                <div style="height:5mm;"></div>

                <t t-foreach="docs" t-as="o">

                    <!-- FULL PAGE BACKGROUND -->
                    <img
                        t-att-src="'/oxord_repair/static/src/img/background.jpg'"
                        style="position:fixed;
                               top:0;
                               left:0;
                               width:100%;
                               height:100%;
                               z-index:-1;
                               object-fit:cover;"
                    />

                    <style>
                        @page {
                            size: A4;
                            margin: 8mm 8mm 8mm 8mm;
                        }
                        main { page-break-after: avoid !important; page-break-before: avoid !important; }
                        .oxord-body-wrapper { width:100%; margin:0 auto; padding:2mm 6mm; box-sizing:border-box; }
                        .oxord-section { background-color:#e0f2f1; color:#004d40; padding:2px 3px; font-weight:bold; margin-top:1mm; border-left:2px solid #00796b; border-radius:3px; font-size:12px; }
                        .tech-box { border:1px solid #00796b; border-radius:5px; padding:4px 6px; margin-bottom:2mm; background-color:#f0f5f5; box-shadow:1px 1px 2px rgba(0,0,0,0.03); font-size:12px; }
                        .tech-box table { width:100%; border-collapse:collapse; }
                        .tech-box td, .tech-box th { padding:2px 3px; font-size:12px; word-wrap:break-word; white-space:pre-wrap; }
                        .oxord-footer { font-size:9px; color:#555; margin-top:6px; text-align:center; }
                    </style>

                    <!-- HEADER -->
                    <div class="oxord-header">
                        <table style="width:100%; border-bottom:2px solid #009688; margin-bottom:1mm;">
                            <tr>
                                <td style="width:22%; padding-left:6mm;">
                                    <img
                                        t-if="o.env.user.company_id.logo"
                                        t-att-src="'data:image/png;base64,%s' % o.env.user.company_id.logo"
                                        style="height:50px;"
                                        alt="Company Logo"
                                    />
                                </td>
                                <td style="color:#004d40;">
                                    <div style="font-weight:bold; font-size:15px;">OXORD COMPUTER SOLUTIONS &amp; REPAIR CENTER</div>
                                    <div style="font-size:11px;">2F Robinsons Place Roxas, Pueblo de Panay Lawa-an, Roxas City</div>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- BODY -->
                    <div class="oxord-body-wrapper">

                        <!-- TECHNICAL REPORT REF -->
                        <div style="font-weight:bold; color:#004d40; font-size:15px; margin-top:2.5mm;">
                            TECHNICAL REPORT REF: <t t-esc="o.name"/>
                        </div>
                        
                        <!-- DATE AND WO -->
                        <div style="font-size:12px; color:#004d40; margin-top:1mm;">
                            Date: <t t-esc="o.report_date and o.report_date.strftime('%Y-%m-%d') or '-'"/><br/>
                            WO: <t t-esc="o.repair_order_id.name or '-'"/>
                        </div>


                        <!-- CUSTOMER INFO -->
                        <div class="oxord-section">Customer Information</div>
                        <div class="tech-box">
                            <table>
                                <tr><td>Customer:</td><td><t t-esc="o.partner_id.name or '-'"/></td></tr>
                                <tr><td>Address:</td><td><t t-esc="o.partner_street or '-'"/></td></tr>
                                <tr><td>Phone:</td><td><t t-esc="o.partner_phone or '-'"/></td></tr>
                                <tr><td>Email:</td><td><t t-esc="o.partner_email or '-'"/></td></tr>
                                <tr><td>Isolation Date:</td><td><t t-esc="o.repair_order_id.pop_date and o.repair_order_id.pop_date.strftime('%Y-%m-%d %H:%M') or '-'"/></td></tr>
                            </table>
                        </div>

                        <!-- UNIT INFO -->
                        <div class="oxord-section">Unit Information</div>
                        <div class="tech-box">
                            <table>
                                <tr><td>Brand:</td><td><t t-esc="o.brand_id.name or '-'"/></td></tr>
                                <tr><td>Model:</td><td><t t-esc="o.model_id.name or '-'"/></td></tr>
                                <tr><td>Serial No.:</td><td><t t-esc="o.serial or '-'"/></td></tr>
                                <tr><td>Accessories:</td><td><t t-esc="' , '.join([a.name for a in o.accessory_ids]) or '-'"/></td></tr>
                                <tr><td>Problems:</td><td><t t-esc="' , '.join([p.name for p in o.problem_ids]) or '-'"/></td></tr>

                            </table>
                        </div>

                        <!-- SERVICE DETAILS -->
                        <div class="oxord-section">Service Resolution</div>
                        <div class="tech-box">
                            <table>                                                                                       
                                <tr t-if="o.problem_note"><td>Problem Notes:</td><td><t t-esc="o.problem_note"/></td></tr>
                                <tr><td>Action Taken:</td><td><t t-esc="o.details or '-'"/></td></tr>
                                <tr><td>Recommendation:</td><td><t t-esc="o.recommendation or '-'"/></td></tr>
                                <tr><td>Status:</td><td><t t-esc="dict(o._fields['status'].selection).get(o.status) or '-'"/></td></tr>
                            </table>
                        </div>

                        <!-- VERIFICATION & APPROVAL -->
                        <div class="oxord-section">Verification &amp; Approval</div>
                        <div class="tech-box">
                            <table style="width:100%; border-collapse:collapse;">
                                <tr>
                                    <!-- LEFT SIDE: Acknowledged & Received -->
                                    <td style="width:40%; vertical-align:top; text-align:left;">
                                        <div><strong>         Acknowledged and Received by:</strong></div>
                                        <div><br/>         Authorized Representative Name &amp; Signature</div>
                                        <div>         Position: ___________</div>
                                        <div>         Date: ______________</div>
                                    </td>
                        
                                    <!-- RIGHT SIDE: Checked & Prepared / Noted By -->
                                    <td style="width:50%; vertical-align:top; text-align:left;">
                                        <div><strong>            Checked &amp; Prepared by:</strong> <t t-esc="o.created_by.name"/> - Technician</div>
                                        <div><strong><br/><br/>             Noted by:</strong> <t t-esc="o.noted_by_id.name"/> - Technical Head</div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FOOTER -->
                        <div class="oxord-footer">
                            This document is system-generated by OXORD DIS
                        </div>

                    </div>

                </t>
            </main>
        </t>
    </template>
</odoo>

