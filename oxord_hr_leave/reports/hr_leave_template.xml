<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_leave_application_document">
        <t t-name="report_leave_application_document">
            <main>
                <t t-foreach="docs" t-as="o">

                    <!-- HEADER -->
                    <table style="width:100%; border-bottom:2px solid #000000; margin-bottom:4mm;">
                        <tr>
                            <td style="width:20%;">
                                <img t-if="o.company_id.logo"
                                     t-att-src="'data:image/png;base64,%s' % o.company_id.logo.decode()"
                                     style="height:50px;"
                                     alt="Company Logo"/>
                            </td>
                            <td style="text-align:center; color:#000000;">
                                <div style="font-weight:bold; font-size:16px;">OXORD COMPUTER SOLUTIONS</div>
                                <div style="font-size:12px;">APPLICATION FOR LEAVE</div>
                            </td>
                        </tr>
                    </table>

                    <style>
                        @page { size:A4; margin:10mm; }
                        main { page-break-after:avoid; page-break-before:avoid; }
                        .section-header {
                            font-weight:bold;
                            margin-top:3mm;
                            margin-bottom:1mm;
                            font-size:12px;
                        }
                        .info-box {
                            border:1px solid #000000;
                            border-radius:3px;
                            padding:3px 5px;
                            margin-bottom:2mm;
                            font-size:12px;
                        }
                        .info-box table {
                            width:100%;
                            border-collapse:collapse;
                        }
                        .info-box td {
                            padding:2px 3px;
                            vertical-align:top;
                        }
                    </style>

                    <!-- SECTION 1 – EMPLOYEE DETAILS -->
                    <div class="section-header">SECTION 1 – EMPLOYEE DETAILS</div>
                    <div class="info-box">
                        <table>
                            <tr>
                                <td>Name:</td>
                                <td><t t-esc="o.employee_id.name"/></td>
                            </tr>
                            <tr>
                                <td>Branch &amp; Position:</td>
                                <td>
                                    <t t-esc="o.employee_id.branch_id.name"/> - 
                                    <t t-esc="o.employee_id.job_id.name"/>
                                </td>
                            </tr>
                            <tr>
                                <td>Department:</td>
                                <td><t t-esc="o.employee_id.department_id.name"/></td>
                            </tr>
                            <tr>
                                <td>Address:</td>
                                <td><t t-esc="o.employee_id.address_home_id.contact_address"/></td>
                            </tr>
                            <tr>
                                <td>Contact Number:</td>
                                <td><t t-esc="o.employee_id.mobile_phone"/></td>
                            </tr>
                        </table>
                    </div>

                    <!-- SECTION 2 – LEAVE DETAILS -->
                    <div class="section-header">SECTION 2 – LEAVE DETAILS</div>
                    <div class="info-box">
                        <table border="1">
                            <tr>
                                <th>Leave Type</th>
                                <th>Hours</th>
                                <th>Days</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                            </tr>
                            <tr>
                                <td>Sick Leave</td>
                                <td><t t-esc="o.number_of_hours_display if o.holiday_status_id.name=='Sick Leave' else 0"/></td>
                                <td><t t-esc="o.number_of_days if o.holiday_status_id.name=='Sick Leave' else 0"/></td>
                                <td><t t-esc="o.date_from if o.holiday_status_id.name=='Sick Leave' else ''"/></td>
                                <td><t t-esc="o.date_to if o.holiday_status_id.name=='Sick Leave' else ''"/></td>
                            </tr>
                            <tr>
                                <td>Vacation Leave</td>
                                <td><t t-esc="o.number_of_hours_display if o.holiday_status_id.name=='Vacation Leave' else 0"/></td>
                                <td><t t-esc="o.number_of_days if o.holiday_status_id.name=='Vacation Leave' else 0"/></td>
                                <td><t t-esc="o.date_from if o.holiday_status_id.name=='Vacation Leave' else ''"/></td>
                                <td><t t-esc="o.date_to if o.holiday_status_id.name=='Vacation Leave' else ''"/></td>
                            </tr>
                            <tr>
                                <td>Maternity/Paternity Leave</td>
                                <td><t t-esc="o.number_of_hours_display if o.holiday_status_id.name=='Maternity/Paternity Leave' else 0"/></td>
                                <td><t t-esc="o.number_of_days if o.holiday_status_id.name=='Maternity/Paternity Leave' else 0"/></td>
                                <td><t t-esc="o.date_from if o.holiday_status_id.name=='Maternity/Paternity Leave' else ''"/></td>
                                <td><t t-esc="o.date_to if o.holiday_status_id.name=='Maternity/Paternity Leave' else ''"/></td>
                            </tr>
                            <tr>
                                <td>Bereavement Leave</td>
                                <td><t t-esc="o.number_of_hours_display if o.holiday_status_id.name=='Bereavement Leave' else 0"/></td>
                                <td><t t-esc="o.number_of_days if o.holiday_status_id.name=='Bereavement Leave' else 0"/></td>
                                <td><t t-esc="o.date_from if o.holiday_status_id.name=='Bereavement Leave' else ''"/></td>
                                <td><t t-esc="o.date_to if o.holiday_status_id.name=='Bereavement Leave' else ''"/></td>
                            </tr>
                            <tr>
                                <td>Other Leave (provide evidence)</td>
                                <td colspan="2"><t t-esc="o.number_of_days if o.holiday_status_id.name=='Other Leave' else 0"/></td>
                                <td><t t-esc="o.date_from if o.holiday_status_id.name=='Other Leave' else ''"/></td>
                                <td><t t-esc="o.date_to if o.holiday_status_id.name=='Other Leave' else ''"/></td>
                            </tr>
                        </table>
                        <t t-if="o.holiday_status_id.name=='Other Leave' and o.evidence">
                            <div style="margin-top:2mm;">
                                Evidence attached
                            </div>
                        </t>
                    </div>

                    <!-- SECTION 3 – PURPOSE / REASON -->
                    <div class="section-header">SECTION 3 – PURPOSE / REASON</div>
                    <div class="info-box" style="min-height:25mm;">
                        <t t-esc="o.description"/>
                    </div>

                    <!-- SECTION 4 – AUTHORIZATION -->
                    <div class="section-header">SECTION 4 – AUTHORIZATION</div>
                    <div class="info-box">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:50%; text-align:left;">
                                    Department Head Signature:<br/><br/><br/>
                                    ______________________________<br/>
                                    Date: ________________________
                                </td>
                                <td style="width:50%; text-align:left;">
                                    Store Manager Signature:<br/><br/><br/>
                                    ______________________________<br/>
                                    Date: ________________________
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align:left; margin-top:3mm;">
                                    HR Signature:<br/><br/><br/>
                                    ______________________________<br/>
                                    Date: ________________________
                                </td>
                            </tr>
                        </table>
                    </div>

                </t>
            </main>
        </t>
    </template>
</odoo>
